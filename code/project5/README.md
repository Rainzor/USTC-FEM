# README

> 王润泽 SA24229016
>
> 有限元方法程序作业5

## 代码说明

`main.m` 代码是程序的入口，主要调用有限元方法求解方程的解，代码最后会输出一系列误差收敛结果。

`fem_solver2d.m` 代码是有限元方法求解二维Dirichlet边值问题的主要程序，利用二次多项式空间求解，包含对应矩阵构造和求解过程。

## 北大天元输出

```sh
N:10, L2: 9.655566e-06
N:10, LH1: 4.335823e-04
N:20, L2: 9.120056e-07
N:20, LH1: 8.159243e-05
N:40, L2: 8.327985e-08
N:40, LH1: 1.492277e-05
N:80, L2: 7.500277e-09
N:80, LH1: 2.707059e-06
N:20, L2 order: 3.404246e+00, LH1 order: 2.409799e+00
N:40, L2 order: 3.453003e+00, LH1 order: 2.450920e+00
N:80, L2 order: 3.472952e+00, LH1 order: 2.462717e+00
```

## 特别声明

在 **MATLAB** 中有方便数值计算的函数，如：`interp2`、`trapz`、`gradient`  函数，由于**北大天元**软件对相关函数接口实现不够充分，导致无法在其中运行代码。

因此，提交的代码中自行实现的简单相关接口函数，包括：

- cubicInterp2WithScaling：计算二维三次多项式插值
- cubicInterpolate：标准的三次样条插值公式来计算插值结果
- rectangle_integral：矩阵法求积分
- gradient_custom：误差梯度计算

在北大天元中运行速度较慢（20分钟），结果精度也比较差，但正确性可以保证。



## Matlab 替代版本

考虑到北大天元矩阵数值计算太慢，且误差计算时没有相关接口，可以修改 `main.m` 中 **33,34行代码**

```matlab
result = interp2(result, k, 'cubic');
%result = cubicInterp2WithScaling(result,k);
```

使用内置的插值计算方式来**求解误差**，速度和精度都能得到保证，结果如下

```sh
N:10, L2: 9.720510e-07
N:10, LH1: 8.040347e-05
N:20, L2: 9.613671e-08
N:20, LH1: 1.795199e-05
N:40, L2: 1.008704e-08
N:40, LH1: 4.187167e-06
N:80, L2: 1.121603e-09
N:80, LH1: 1.006554e-06
N:20, L2 order: 3.337873e+00, LH1 order: 2.163114e+00
N:40, L2 order: 3.252585e+00, LH1 order: 2.100097e+00
N:80, L2 order: 3.168868e+00, LH1 order: 2.056550e+00
```

